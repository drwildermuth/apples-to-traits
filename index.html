<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Traits to Apples</title>
  <style>
body {
  box-sizing: border-box;
  margin: 0;
  padding: 20px;
  font-family: Calibri, 'Segoe UI', Arial, system-ui, sans-serif;
  background: #f5f5f0;
  color: #333;
}

*, *::before, *::after {
  box-sizing: inherit;
}

html, body {
  height: 100%;
}

:root {
  --card-w: 110px;
  --card-h: 140px;
  --card-font: 12px;
  --pile-w: 120px;
  --pile-h: 160px;
}

.header {
  background: white;
  padding: 16px;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  margin-bottom: 20px;
}

.header h1 {
  margin: 0 0 16px 0;
  color: #950f08;
  font-size: 28px;
}

.controls {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  align-items: center;
}

.control-group {
  display: flex;
  align-items: center;
  gap: 8px;
}

.control-group label {
  font-weight: 600;
  font-size: 14px;
}

.control-group select,
.control-group input[type="number"] {
  padding: 6px 10px;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-family: inherit;
  font-size: 14px;
}

.control-group input[type="number"] {
  width: 60px;
}

.control-group button {
  padding: 8px 16px;
  background: #950f08;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-family: inherit;
  font-size: 14px;
  font-weight: 600;
}

.control-group button:hover {
  background: #7a0c06;
}

.control-group button:active {
  transform: translateY(1px);
}

.control-group input[type="checkbox"] {
  width: 18px;
  height: 18px;
  cursor: pointer;
}

.control-group a {
  color: #950f08;
  text-decoration: none;
  font-weight: 600;
}

.control-group a:hover {
  text-decoration: underline;
}

.board {
  display: grid;
  grid-template-columns: 1fr 2fr 1fr;
  gap: 20px;
  margin-bottom: 20px;
}

.column {
  background: white;
  padding: 16px;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.column h2 {
  margin: 0 0 16px 0;
  font-size: 18px;
  color: #950f08;
}

.deck-area {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 12px;
}

.card-pile {
  width: var(--pile-w);
  height: var(--pile-h);
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: white;
  box-shadow: 0 4px 12px rgba(0,0,0,0.2);
  cursor: pointer;
  position: relative;
  transition: transform 0.2s;
}

.card-pile:hover {
  transform: translateY(-4px);
}

.card-pile.red {
  background: #c7634c;
}

.card-pile.green {
  background: #6ac466;
}

.apple-icon {
  position: absolute;
  bottom: 8px;
  right: 8px;
  width: 18px;
  height: 18px;
  background: transparent;
  border: 2px solid rgba(255,255,255,0.9);
  border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
  opacity: 0.95;
}

.apple-icon::before {
  content: '';
  position: absolute;
  top: -6px;
  right: 6px;
  width: 4px;
  height: 8px;
  background: transparent;
  border: 2px solid rgba(255,255,255,0.9);
  border-bottom: none;
  border-radius: 50% 50% 0 0;
  transform: rotate(20deg);
}

.apple-icon::after {
  content: '';
  position: absolute;
  top: -4px;
  right: 4px;
  width: 6px;
  height: 4px;
  background: transparent;
  border: 1px solid rgba(255,255,255,0.9);
  border-bottom: none;
  border-radius: 50% 50% 0 0;
  transform: rotate(-30deg);
}

.hide-apple .apple-icon {
  display: none;
}

.draw-btn {
  padding: 8px 16px;
  background: #950f08;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-family: inherit;
  font-size: 14px;
  font-weight: 600;
}

.draw-btn:hover {
  background: #7a0c06;
}

.center-area {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.flipped-card {
  min-height: 120px;
  background: #6ac466;
  border-radius: 8px;
  padding: 16px;
  color: white;
  box-shadow: 0 4px 12px rgba(0,0,0,0.2);
  position: relative;
}

.flipped-card h3 {
  margin: 0 0 8px 0;
  font-size: 20px;
}

.flipped-card p {
  margin: 0;
  font-size: 14px;
  opacity: 0.95;
}

.played-area {
  min-height: 200px;
  border: 2px dashed #ccc;
  border-radius: 8px;
  padding: 16px;
  background: #fafafa;
}

.played-area.drag-over {
  background: #e8f5e9;
  border-color: #6ac466;
}

.played-area h3 {
  margin: 0 0 12px 0;
  font-size: 16px;
  color: #666;
}

.played-cards {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
}

.rules {
  font-size: 14px;
  line-height: 1.6;
}

.rules ol {
  margin: 8px 0;
  padding-left: 20px;
}

.rules li {
  margin-bottom: 8px;
}

.players-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 16px;
}

.players-grid.layout-table {
  grid-template-columns: repeat(2, 1fr);
}

.player-panel {
  background: white;
  padding: 16px;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  border: 3px solid transparent;
}

.player-panel.current-player {
  border-color: #950f08;
}

.player-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px;
}

.player-name {
  font-weight: bold;
  font-size: 16px;
}

.player-score {
  display: flex;
  align-items: center;
  gap: 8px;
}

.score-btn {
  width: 28px;
  height: 28px;
  border: 2px solid #950f08;
  background: white;
  color: #950f08;
  border-radius: 50%;
  cursor: pointer;
  font-size: 16px;
  font-weight: bold;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s;
}

.score-btn:hover {
  background: #950f08;
  color: white;
}

.score-btn:active {
  transform: scale(0.95);
}

.score-value {
  font-size: 18px;
  font-weight: bold;
  color: #950f08;
  min-width: 24px;
  text-align: center;
}

.player-hand {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 8px;
  min-height: 100px;
}

.card {
  width: var(--card-w);
  height: var(--card-h);
  background: #c7634c;
  border-radius: 8px;
  padding: 12px;
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  font-size: var(--card-font);
  font-weight: 600;
  box-shadow: 0 4px 12px rgba(0,0,0,0.2);
  cursor: grab;
  user-select: none;
  position: relative;
  transition: transform 0.2s, box-shadow 0.2s;
}

.card:hover {
  transform: translateY(-4px);
  box-shadow: 0 6px 16px rgba(0,0,0,0.3);
}

.card.dragging {
  opacity: 0.5;
  cursor: grabbing;
}

.card.played {
  cursor: pointer;
}

.card.played:hover {
  transform: scale(1.05);
}

.card.winner {
  animation: winner-pulse 0.6s ease-out;
}

@keyframes winner-pulse {
  0%, 100% {
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
  }
  50% {
    box-shadow: 0 0 0 4px gold, 0 4px 12px rgba(0,0,0,0.2);
  }
}

.size-small {
  --card-w: 100px;
  --card-h: 130px;
  --card-font: 11px;
  --pile-w: 90px;
  --pile-h: 120px;
}

.size-large {
  --card-w: 180px;
  --card-h: 230px;
  --card-font: 16px;
  --pile-w: 150px;
  --pile-h: 200px;
}

@media (max-width: 768px) {
  .board {
    grid-template-columns: 1fr;
  }
  
  .players-grid {
    grid-template-columns: 1fr;
  }
}
</style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="header">
   <h1 id="game-title">Traits to Apples</h1>
   <div class="controls">
    <div class="control-group"><label for="player-count">Players:</label> <input type="number" id="player-count" min="3" max="6" value="4">
    </div>
    <div class="control-group"><button id="setup-btn">Set up</button>
    </div>
    <div class="control-group"><button id="deal-btn">Deal 4 each</button>
    </div>
    <div class="control-group"><button id="flip-btn">Flip green</button>
    </div>
    <div class="control-group"><button id="new-round-btn">New round</button>
    </div>
    <div class="control-group"><label for="card-size">Card size:</label> <select id="card-size"> <option value="small">Small</option> <option value="medium" selected>Medium</option> <option value="large">Large</option> </select>
    </div>
    <div class="control-group"><label for="layout-mode">Layout:</label> <select id="layout-mode"> <option value="auto" selected>Auto</option> <option value="table">Table 2×2</option> </select>
    </div>
    <div class="control-group"><input type="checkbox" id="apple-toggle" checked> <label for="apple-toggle">Show apple icon</label>
    </div>
    <div class="control-group"><a href="#rules" id="instructions-link">How to play</a>
    </div>
   </div>
  </div>
  <div class="board">
   <div class="column">
    <h2>Red Deck</h2>
    <div class="deck-area">
     <div class="card-pile red" id="red-deck"><span id="red-count">200</span>
      <div class="apple-icon"></div>
     </div><button class="draw-btn" id="draw-red-btn">Draw 1 to current player</button>
    </div>
   </div>
   <div class="column">
    <h2>Green Card</h2>
    <div class="center-area">
     <div class="deck-area">
      <div class="card-pile green" id="green-deck"><span id="green-count">23</span>
       <div class="apple-icon"></div>
      </div>
     </div>
     <div class="flipped-card" id="flipped-green" style="display: none;">
      <h3 id="green-trait"></h3>
      <p id="green-definition"></p>
      <div class="apple-icon"></div>
     </div>
     <div class="played-area" id="played-area">
      <h3>Played cards</h3>
      <div class="played-cards" id="played-cards"></div>
     </div>
    </div>
   </div>
   <div class="column">
    <h2>Round Controls</h2>
    <div class="rules" id="rules">
     <ol>
      <li>Choose 3–6 players, then <strong>Set up</strong></li>
      <li>Click <strong>Deal 4 each</strong> to give cards</li>
      <li>Click <strong>Flip green</strong> to reveal a trait</li>
      <li>Each player drags one red card to <strong>Played cards</strong></li>
      <li>Judge clicks a played card to award 1 point</li>
      <li>Click <strong>New round</strong> to continue</li>
     </ol>
    </div>
   </div>
  </div>
  <div class="players-grid" id="players-grid"></div>
  <script src="/_sdk/element_sdk.js"></script>
  <script>
const GREEN_CARDS = [
  { name: "Carefree", definition: "Free from anxiety or responsibility" },
  { name: "Peace", definition: "A state of tranquility and calm" },
  { name: "Optimism", definition: "Hopefulness about the future" },
  { name: "Confidence", definition: "Belief in one's abilities" },
  { name: "Composure", definition: "Remaining calm under pressure" },
  { name: "Assertiveness", definition: "Standing up for oneself" },
  { name: "Taking the Lead", definition: "Initiating action and guiding others" },
  { name: "Gregariousness", definition: "Enjoying social interaction" },
  { name: "Approachability", definition: "Being easy to talk to" },
  { name: "Energy Level", definition: "Vitality and enthusiasm" },
  { name: "Imagination", definition: "Creative and inventive thinking" },
  { name: "Change", definition: "Embracing new experiences" },
  { name: "Viewpoint", definition: "Unique perspective on life" },
  { name: "Complexity", definition: "Depth of thought and feeling" },
  { name: "Trust", definition: "Believing in others' goodness" },
  { name: "Empathy", definition: "Understanding others' feelings" },
  { name: "Service", definition: "Helping and supporting others" },
  { name: "Humility", definition: "Modest view of one's importance" },
  { name: "Tact", definition: "Sensitivity in dealing with others" },
  { name: "Self-Discipline", definition: "Control over one's actions" },
  { name: "Drive", definition: "Motivation to achieve goals" },
  { name: "Organization", definition: "Systematic and orderly approach" },
  { name: "Perfectionism", definition: "Striving for flawlessness" }
];

const RED_CARDS = [
  "A walk in the park","Watching a football game","A rainy vacation","A beach day","Reading in bed",
  "Singing in the shower","Playing board games","A movie marathon","Baking cookies","A road trip",
  "A day at the theme park","Dancing when no one's watching","Finishing before the deadline","Getting honest feedback","Starting a new project",
  "Asking for help","Admitting a mistake","Helping a coworker","Taking the blame","Delegating a task",
  "Leading from behind","A pineapple on pizza","A mystery text message","Losing your keys","Finding a lucky penny",
  "Talking to plants","Wearing mismatched socks","Forgetting someone's name","An awkward silence","Accidentally hitting Reply All",
  "A song stuck in your head","A missed flight","Traveling light","Climbing a mountain","Exploring a new city",
  "Getting lost","A hotel upgrade","Flying first class","A road trip playlist","Jet lag",
  "Being the center of attention","Avoiding conflict","Laughing too loudly","Saying sorry first","Changing your mind",
  "Overthinking everything","Taking a big risk","Giving up control","Keeping a secret","Telling the truth",
  "A long grocery line","Spilling your coffee","Running late","Waiting for a text back","A surprise party",
  "Waking up early","Sleeping in","A power nap","Staying up all night","A morning routine",
  "Breaking a habit","Starting a new hobby","Quitting something","Trying again","Giving up",
  "A compliment from a stranger","Constructive criticism","Being ignored","Getting recognized","Blending in",
  "Standing out","Following the crowd","Going against the grain","Peer pressure","Independence",
  "A group project","Working alone","Brainstorming ideas","Executing a plan","Improvising",
  "Sticking to the script","A surprise twist","Predictability","Spontaneity","Routine",
  "Adventure","Comfort zone","Taking a chance","Playing it safe","A calculated risk",
  "Blind faith","Skepticism","Curiosity","Indifference","Passion",
  "Apathy","Enthusiasm","Burnout","Motivation","Procrastination",
  "Productivity","Multitasking","Focus","Distraction","Flow state",
  "Writer's block","Creative breakthrough","Practice","Natural talent","Hard work",
  "Luck","Preparation","Opportunity","Timing","Patience",
  "Urgency","Waiting","Rushing","Taking your time","Deadlines",
  "Freedom","Structure","Rules","Flexibility","Compromise",
  "Stubbornness","Open-mindedness","Tradition","Innovation","Evolution",
  "Revolution","Stability","Change","Growth","Stagnation",
  "Progress","Setback","Success","Failure","Learning",
  "Teaching","Listening","Speaking","Silence","Noise",
  "Chaos","Order","Balance","Extremes","Moderation",
  "Excess","Minimalism","Abundance","Scarcity","Gratitude",
  "Entitlement","Humility","Pride","Shame","Guilt",
  "Forgiveness","Resentment","Letting go","Holding on","Closure",
  "Unfinished business","A fresh start","A second chance","Moving on","Looking back",
  "Nostalgia","Living in the moment","Future planning","Daydreaming","Reality check",
  "Optimism","Pessimism","Realism","Idealism","Cynicism",
  "Hope","Despair","Joy","Sadness","Anger",
  "Fear","Love","Hate","Indifference","Compassion",
  "Cruelty","Kindness","Generosity","Selfishness","Sacrifice"
];

let redDeck = [...RED_CARDS];
let greenDeck = [...GREEN_CARDS];
let players = [];
let currentPlayerIndex = 0;
let flippedGreen = null;
let playedCards = [];

const defaultConfig = {
  game_title: "Traits to Apples",
  instructions_text: "How to play"
};

function shuffleArray(array) {
  const shuffled = [...array];
  for (let i = shuffled.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
  }
  return shuffled;
}

function setupGame() {
  const count = parseInt(document.getElementById('player-count').value);
  if (count < 3 || count > 6) {
    showMessage('Please choose 3-6 players');
    return;
  }
  
  players = [];
  for (let i = 0; i < count; i++) {
    players.push({
      name: `Player ${i + 1}`,
      score: 0,
      hand: []
    });
  }
  
  currentPlayerIndex = 0;
  redDeck = shuffleArray(RED_CARDS);
  greenDeck = shuffleArray(GREEN_CARDS);
  flippedGreen = null;
  playedCards = [];
  
  renderPlayers();
  updateDeckCounts();
  clearFlippedGreen();
  clearPlayedCards();
  showMessage('Game set up! Click "Deal 4 each" to start');
}

function dealCards() {
  if (players.length === 0) {
    showMessage('Please set up the game first');
    return;
  }
  
  for (let player of players) {
    while (player.hand.length < 4 && redDeck.length > 0) {
      player.hand.push(redDeck.pop());
    }
  }
  
  renderPlayers();
  updateDeckCounts();
  showMessage('Cards dealt! Click "Flip green" to reveal a trait');
}

function flipGreen() {
  if (greenDeck.length === 0) {
    showMessage('No more green cards!');
    return;
  }
  
  flippedGreen = greenDeck.pop();
  document.getElementById('green-trait').textContent = flippedGreen.name;
  document.getElementById('green-definition').textContent = flippedGreen.definition;
  document.getElementById('flipped-green').style.display = 'block';
  updateDeckCounts();
  showMessage('Green card flipped! Players, play your cards');
}

function newRound() {
  clearPlayedCards();
  clearFlippedGreen();
  currentPlayerIndex = (currentPlayerIndex + 1) % players.length;
  renderPlayers();
  showMessage('New round! Click "Flip green" when ready');
}

function drawRedCard() {
  if (players.length === 0) {
    showMessage('Please set up the game first');
    return;
  }
  
  if (redDeck.length === 0) {
    showMessage('Red deck is empty!');
    return;
  }
  
  players[currentPlayerIndex].hand.push(redDeck.pop());
  renderPlayers();
  updateDeckCounts();
}

function clearFlippedGreen() {
  document.getElementById('flipped-green').style.display = 'none';
  flippedGreen = null;
}

function clearPlayedCards() {
  playedCards = [];
  document.getElementById('played-cards').innerHTML = '';
}

function updateDeckCounts() {
  document.getElementById('red-count').textContent = redDeck.length;
  document.getElementById('green-count').textContent = greenDeck.length;
}

function renderPlayers() {
  const grid = document.getElementById('players-grid');
  grid.innerHTML = '';
  
  players.forEach((player, index) => {
    const panel = document.createElement('div');
    panel.className = 'player-panel';
    if (index === currentPlayerIndex) {
      panel.classList.add('current-player');
    }
    
    const header = document.createElement('div');
    header.className = 'player-header';
    
    const name = document.createElement('div');
    name.className = 'player-name';
    name.textContent = index === currentPlayerIndex ? `★ ${player.name}` : player.name;
    
    const score = document.createElement('div');
    score.className = 'player-score';
    
    const minusBtn = document.createElement('button');
    minusBtn.className = 'score-btn minus';
    minusBtn.textContent = '−';
    minusBtn.onclick = () => adjustScore(index, -1);
    
    const scoreValue = document.createElement('span');
    scoreValue.className = 'score-value';
    scoreValue.textContent = player.score;
    
    const plusBtn = document.createElement('button');
    plusBtn.className = 'score-btn plus';
    plusBtn.textContent = '+';
    plusBtn.onclick = () => adjustScore(index, 1);
    
    score.appendChild(minusBtn);
    score.appendChild(scoreValue);
    score.appendChild(plusBtn);
    
    header.appendChild(name);
    header.appendChild(score);
    
    const hand = document.createElement('div');
    hand.className = 'player-hand';
    hand.dataset.playerIndex = index;
    
    player.hand.forEach((cardText, cardIndex) => {
      const card = createCard(cardText, index, cardIndex);
      hand.appendChild(card);
    });
    
    panel.appendChild(header);
    panel.appendChild(hand);
    grid.appendChild(panel);
  });
}

function createCard(text, playerIndex, cardIndex) {
  const card = document.createElement('div');
  card.className = 'card';
  card.textContent = text;
  card.draggable = true;
  card.dataset.playerIndex = playerIndex;
  card.dataset.cardIndex = cardIndex;
  card.dataset.cardText = text;
  
  const appleIcon = document.createElement('div');
  appleIcon.className = 'apple-icon';
  card.appendChild(appleIcon);
  
  card.addEventListener('dragstart', handleDragStart);
  card.addEventListener('dragend', handleDragEnd);
  
  return card;
}

function handleDragStart(e) {
  e.target.classList.add('dragging');
  e.dataTransfer.effectAllowed = 'move';
  e.dataTransfer.setData('text/plain', JSON.stringify({
    playerIndex: e.target.dataset.playerIndex,
    cardIndex: e.target.dataset.cardIndex,
    cardText: e.target.dataset.cardText
  }));
}

function handleDragEnd(e) {
  e.target.classList.remove('dragging');
}

function showMessage(msg) {
  const rulesDiv = document.getElementById('rules');
  const existingMsg = rulesDiv.querySelector('.message');
  if (existingMsg) {
    existingMsg.remove();
  }
  
  const message = document.createElement('div');
  message.className = 'message';
  message.style.cssText = 'background: #e8f5e9; padding: 12px; border-radius: 4px; margin-bottom: 12px; font-weight: 600; color: #2e7d32;';
  message.textContent = msg;
  rulesDiv.insertBefore(message, rulesDiv.firstChild);
  
  setTimeout(() => message.remove(), 3000);
}

const playedArea = document.getElementById('played-area');
const playedCardsContainer = document.getElementById('played-cards');

playedArea.addEventListener('dragover', (e) => {
  e.preventDefault();
  e.dataTransfer.dropEffect = 'move';
  playedArea.classList.add('drag-over');
});

playedArea.addEventListener('dragleave', () => {
  playedArea.classList.remove('drag-over');
});

playedArea.addEventListener('drop', (e) => {
  e.preventDefault();
  playedArea.classList.remove('drag-over');
  
  const data = JSON.parse(e.dataTransfer.getData('text/plain'));
  const playerIndex = parseInt(data.playerIndex);
  const cardIndex = parseInt(data.cardIndex);
  const cardText = data.cardText;
  
  players[playerIndex].hand.splice(cardIndex, 1);
  
  playedCards.push({
    text: cardText,
    playerIndex: playerIndex
  });
  
  const playedCard = document.createElement('div');
  playedCard.className = 'card played';
  playedCard.textContent = cardText;
  playedCard.dataset.playedIndex = playedCards.length - 1;
  
  const appleIcon = document.createElement('div');
  appleIcon.className = 'apple-icon';
  playedCard.appendChild(appleIcon);
  
  playedCard.addEventListener('click', handlePlayedCardClick);
  
  playedCardsContainer.appendChild(playedCard);
  renderPlayers();
});

function handlePlayedCardClick(e) {
  const playedIndex = parseInt(e.currentTarget.dataset.playedIndex);
  const playedCard = playedCards[playedIndex];
  
  players[playedCard.playerIndex].score++;
  
  e.currentTarget.classList.add('winner');
  
  setTimeout(() => {
    e.currentTarget.classList.remove('winner');
  }, 600);
  
  renderPlayers();
  showMessage(`${players[playedCard.playerIndex].name} wins this round!`);
}

function adjustScore(playerIndex, change) {
  if (players[playerIndex]) {
    players[playerIndex].score = Math.max(0, players[playerIndex].score + change);
    renderPlayers();
  }
}

document.getElementById('setup-btn').addEventListener('click', setupGame);
document.getElementById('deal-btn').addEventListener('click', dealCards);
document.getElementById('flip-btn').addEventListener('click', flipGreen);
document.getElementById('new-round-btn').addEventListener('click', newRound);
document.getElementById('draw-red-btn').addEventListener('click', drawRedCard);

document.getElementById('card-size').addEventListener('change', (e) => {
  document.body.className = `size-${e.target.value}`;
});

document.getElementById('layout-mode').addEventListener('change', (e) => {
  const grid = document.getElementById('players-grid');
  if (e.target.value === 'table') {
    grid.classList.add('layout-table');
  } else {
    grid.classList.remove('layout-table');
  }
});

document.getElementById('apple-toggle').addEventListener('change', (e) => {
  if (e.target.checked) {
    document.body.classList.remove('hide-apple');
  } else {
    document.body.classList.add('hide-apple');
  }
});

async function onConfigChange(config) {
  const titleElement = document.getElementById('game-title');
  const instructionsElement = document.getElementById('instructions-link');
  
  titleElement.textContent = config.game_title || defaultConfig.game_title;
  instructionsElement.textContent = config.instructions_text || defaultConfig.instructions_text;
}

if (window.elementSdk) {
  window.elementSdk.init({
    defaultConfig,
    onConfigChange,
    mapToCapabilities: (config) => ({
      recolorables: [],
      borderables: [],
      fontEditable: undefined,
      fontSizeable: undefined
    }),
    mapToEditPanelValues: (config) => new Map([
      ["game_title", config.game_title || defaultConfig.game_title],
      ["instructions_text", config.instructions_text || defaultConfig.instructions_text]
    ])
  });
}
</script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'997d10c2b60a4f2a',t:'MTc2MjAxNzY1NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
